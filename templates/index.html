{% extends "base.html" %}
{% block content %}
<div class="row">
	<div class="carousel carousel-slider" id="features" style="position: relative">
	    <a class="carousel-item" href="#one!"><img src="https://s3-eu-west-1.amazonaws.com/ci-cookbook/pancakes.jpg"></a>
	    <a class="carousel-item" href="#two!"><img src="https://s3-eu-west-1.amazonaws.com/ci-cookbook/pancakes.jpg"></a>
	    <a class="carousel-item" href="#three!"><img src="https://s3-eu-west-1.amazonaws.com/ci-cookbook/pancakes.jpg"></a>
	    <a class="carousel-item" href="#four!"><img src="https://s3-eu-west-1.amazonaws.com/ci-cookbook/pancakes.jpg"></a>
	    <div class="controls valign-wrapper" style="position: absolute; top: 0; width: 100%; height: 100%;">
	    	<div style="width: 100%; padding: 3%;">
                <a class="btn-floating btn-large waves-effect waves-light left" id="carousel-left"><i class="material-icons">chevron_left</i></a>
				<a class="btn-floating btn-large waves-effect waves-light right" id="carousel-right"><i class="material-icons">chevron_right</i></a>
	    	</div>
	    </div>
  	</div>
</div>
<div class="row">
    <div class="col s12">
      <ul class="tabs" id="tabs">
        <li class="tab col s3"><a class="active" href="#test1">Recent Recipes</a></li>
        <li class="tab col s3"><a href="#test2">Popular Recipes</a></li>
        <li class="tab col s3"><a href="#test3">About Fork.it</a></li>
      </ul>
    </div>
    <div id="test1" class="col s12">
        <div class="row">
        {% for recipe in recipes %}
            <div class="col s12 m6">
                <a href="{{ url_for('recipe', urn=recipe['urn']) }}">
                {% if recipe['image'] %}
                <img src="{{ recipe['image'] }}" alt="{{ recipe['title'] }}" class="responsive-img">
                {% endif %}
                {{ recipe['title'] }}</a> by {{ recipe['username'] }}
            </div>
        {% endfor %}
        </div>
        <div class="row">
            <div class="col s12 center">
                <ul class="pagination">
                {% set max_page = ((no_recipes - 1)/10|round(0,'ceil'))|int %}
                {% if page > 1 %}<li class="waves-effect"><a href="{{ url_for(endpoint='recipes', page=page - 1, **current_query) }}"><i class="material-icons">chevron_left</i></a></li>
                {% else %}<li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>{% endif %}
                {% for number in range ([[page -2, max_page - 4]|min, 1]|max, [[page + 2, 5]|max, max_page + 1]|min + 1) %}
                    {% if page == number %}
                    <li class="active"><a href="#!">{{ number }}</a></li>
                    {% else %}
                    <li class="waves-effect"><a href="{{ url_for(endpoint='recipes', page=number, **current_query) }}">{{ number }}</a></li>
                    {% endif %}
                {% endfor %}
                {% if page <= max_page %}<li class="waves-effect"><a href="{{ url_for(endpoint='recipes', page=page + 1, **current_query,) }}"><i class="material-icons">chevron_right</i></a></li>
                {% else %}<li class="disabled"><a href="#!"><i class="material-icons">chevron_right</i></a></li>
                {% endif %}
              </ul>
            </div>
        </div>
    </div>
    <div id="test2" class="col s12">Test 2</div>
    <div id="test3" class="col s12">Test 3</div>
</div>
{% endblock %}
{% block javascript %}
<script>
	const $ = cash;
    $(function() {
    	M.Tabs.init($('#tabs'));
        let features = M.Carousel.init($('#features')[0], {fullWidth: true, dist: 0, indicators: true});
        $('#carousel-left').on('click', function() {
        	features.prev();
        });
        $('#carousel-right').on('click', function() {
        	features.next();
        });
  	});
</script>
{% endblock %}